import{a as T,s as g,r as y,b as h,c as M,n as C,N as S}from"./pagination-markup-28d202f7.js";document.addEventListener("DOMContentLoaded",function(){document.getElementById("logo-link").addEventListener("click",function(){window.location.href="./index.html"}),document.getElementById("subscription-form").addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("email-input"),r=t.value;if(console.log(r),!t.checkValidity()){alert("https://your-energy.b.goit.study/api/subscription");return}fetch("https://your-energy.b.goit.study/api/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}).then(n=>n.json()).then(n=>{if(console.log(n.message),n.message==="Service not found")throw Error("Request error. Please try again later.");alert("You have successfully subscribed to receive new exercises!"),t.value=""}).catch(n=>{alert(n)})})});let q=document.querySelector(".top-button");window.onscroll=function(){Y()};function Y(){document.body.scrollTop>200||document.documentElement.scrollTop>200?q.style.display="block":q.style.display="none"}q.addEventListener("click",Q);function Q(){window.scrollTo({top:0,behavior:"smooth"})}async function P(e,t=1){let{filter:r="",category:n="",keyword:s=""}=e;switch(r){case"Body parts":r="bodypart";break;case"Muscles":r="muscles";break;case"Equipment":r="equipment";break}const u=new URLSearchParams({[r]:n,keyword:s,page:t,limit:window.innerWidth<768?8:10});return(await T.get("/exercises",{params:u})).data}function $(e){return e.map(t=>{const{rating:r,name:n,burnedCalories:s,time:u,bodyPart:b,target:w,_id:k}=t;return`
      <li class="item">
        <div class="item-header">
          <span class='item-workout'>Workout</span>
          <p class='item-rating js-rating'>${Number.isInteger(r)?`${r}.0`:r}</p>
          <svg class="rating-star" width="18" height="18">
            <use href="${g}#icon-exercises-content-gold-star"></use>
          </svg>
        </div>

        <div class="item-body">
          <svg class="" width="24" height="24">
            <use href="${g}#icon-running-man"></use>
          </svg>
          <h3 class="item-title js-item-title">${n}</h3>
        </div>

        <div class='item-footer'>
          <p>Burned calories: <span>${s} / ${u} min</span></p>
          <p>Body part: <span class="capitalize">${b}</span></p>
          <p>Target: <span class="capitalize">${w}</span></p>
        </div>

        <button class='item-button' data-id=${k} data-modal-open>Start
          <svg class="start-icon" width="16" height="16">
            <use href="${g}#icon-scroll-arrow"></use>
          </svg>
        </button>
      </li>
    `}).join("")}async function F(e,t){const n=new URLSearchParams({filter:e,page:t,limit:window.innerWidth<768?9:12});return await T.get("/filters",{params:n}).then(s=>s.data)}function Z(e){return e.map(({filter:t,name:r,imgURL:n})=>`
        <li class = "new-exercises-item">  
          <div class = "exercises-filter-IMG js-category-item js-item" style="
          background: linear-gradient(0deg, rgba(17, 17, 17, 0.50) 0%, rgba(17, 17, 17, 0.50) 100%), url('${n}'), lightgray -19.24px -11px / 112.354% 111.111% no-repeat; background-size: contain; background-size: cover;" data-category="${r}">
            <div class="container-for-h2-and-p-card">
              <h3 class="exercises-title-of-item js-item">${r}</h3>
              <p class="exercises-text-of-item js-item">${t}</p>
            </div>              
          </div>            
        </li>`).join("")}const A=`
  <div class="loader">
    <svg class="" width="24" height="24">
      <use href="${g}#icon-aside-barbell"></use>
    </svg>
  </div>
`,i={list:document.querySelector(".exercises-filter-list"),newList:document.querySelector(".list-for-new-exercises"),bodyPartsItem:document.querySelector(".filter-of-body-parts"),musclesItem:document.querySelector(".filter-of-muscles"),equipmentItem:document.querySelector(".filter-of-equipment"),pagination:document.querySelector(".pagination-nav"),title:document.querySelector(".exercises-main-title"),form:document.querySelector(".js-form")};let m=1;i.list.addEventListener("click",ee);i.newList.innerHTML=A;F(i.list.dataset.filter,m).then(e=>{e.totalPages===1&&(i.pagination.style.display="none"),i.newList.innerHTML="",N(e.results);let t=y(e.totalPages,m);i.pagination.innerHTML=h(m,t),i.pagination.addEventListener("click",I)}).catch(e=>{console.error("Error: ",e),M.Notify.failure("Oops. Something went wrong. Try reloading the page")});function ee(e){const t=e.target.dataset.category;e.target.classList.contains("exercises-filter-btn")&&([...e.currentTarget.children].forEach(r=>{r.children[0].classList.remove("active"),r.children[0].disabled=!1}),e.target.classList.add("active"),e.target.disabled=!0,i.title.textContent="Exercises",i.form.classList.add("is-hidden"),i.list.dataset.filter=t,F(t,m).then(r=>{r.totalPages<=1?i.pagination.style.display="none":i.pagination.style.display="block ",N(r.results);let n=y(r.totalPages,m);i.pagination.innerHTML=h(m,n),i.pagination.removeEventListener("click",D),i.pagination.addEventListener("click",I)}).catch(r=>{console.error("Error: ",r),M.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}function I(e){let t=e.target.dataset.page;t==="..."||!e.target.classList.contains("js-page-link")||t===""||e.target.classList.contains("active")||(window.scrollTo({top:i.title.offsetTop-60}),t=Number(t),F(i.list.dataset.filter,t).then(r=>{N(r.results);let n=y(r.totalPages,t);i.pagination.innerHTML=h(t,n)}).catch(r=>{console.error("Error: ",r),M.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}function N(e){Array.isArray(e)?i.newList.innerHTML=Z(e):console.error("Data is not an array:",e)}const v=document.querySelector(".js-form"),te=document.querySelector(".exercises-main-title"),O=document.querySelector(".exercises-filter-list"),d=document.querySelector(".list-for-new-exercises");document.querySelector(".js-filter-nav");const l=document.querySelector(".pagination-nav"),c={filter:"",category:"",keyword:""};let f=1;d.addEventListener("click",re);function D(e){let t=e.target.dataset.page;t==="..."||!e.target.classList.contains("js-page-link")||e.target.classList.contains("active")||(window.scrollTo({top:d.offsetTop-210}),t=Number(t),P(c,t).then(r=>{d.innerHTML=$(r.results);let n=y(r.totalPages,t);l.innerHTML=h(t,n)}).catch(r=>{console.error(r),C.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}function re(e){e.target.classList.contains("js-item")&&(O.querySelector(".active").disabled=!1,d.innerHTML=A,v.reset(),l.removeEventListener("click",I),l.addEventListener("click",D),c.filter=O.dataset.filter,c.category=e.target.closest(".js-category-item").dataset.category,v.classList.remove("is-hidden"),v.addEventListener("input",ie),P(c,f).then(t=>{t.totalPages<=1&&(l.style.display="none");const r=c.category[0].toUpperCase()+c.category.slice(1);d.innerHTML="",te.innerHTML=`Exercises / <span>${r}</span>`,d.innerHTML=$(t.results);let n=y(t.totalPages,f);l.innerHTML=h(f,n)}).catch(t=>{console.error(t),C.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}const ne=`
  <svg class="search-icon" width="26" height="26">
    <use href="${g}#icon-search"></use>
  </svg>
`,se=`
  <svg class="clear-icon" width="18" height="18">
    <use href="${g}#icon-remove"></use>
  </svg>
`;function ie(e){const{input:t,button:r}=e.currentTarget.elements;t.value.length>0?(r.innerHTML=se,r.addEventListener("click",R)):(r.removeEventListener("click",R),r.innerHTML=ne);const n=t.value.replace(/\s{2,}/g," ");t.value=n,c.keyword=n,P(c,f).then(s=>{if(s.results.length===0){d.innerHTML='<p><b style="font-size: 28px">No matches found</b> <br>Please try another search</p>',l.innerHTML="";return}s.totalPages<=1?l.style.display="none":l.style.display="block",d.innerHTML=$(s.results);let u=y(s.totalPages,f);l.innerHTML=h(f,u)}).catch(s=>{console.error(s),C.Notify.failure("Oops. Something went wrong. Try reloading the page")}).finally(()=>{c.keyword=""})}function R(){v.reset();const e=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(e)}const p=document.querySelector(".backdrop-ex"),oe=document.querySelector(".modal-close-btn"),E=document.querySelector(".modal-ex"),ae="favoriteExercises";oe.addEventListener("click",L);document.addEventListener("keydown",j);const V=document.querySelector(".rating-feedback-form");p.addEventListener("click",e=>{e.target===p&&(L(),V.classList.add("is-hidden"))});function ce(){E&&(document.querySelector("body").style.overflow="hidden",E.classList.remove("is-hidden"),p.classList.remove("is-hidden"),document.addEventListener("keydown",j),E.addEventListener("click",e=>{e.stopPropagation()}),p.removeEventListener("click",L),J(a[0]._id))}function L(){E&&(document.querySelector("body").style.overflow="visible",E.classList.add("is-hidden"),document.removeEventListener("keydown",j),p.removeEventListener("click",L),p.classList.add("is-hidden"),V.classList.add("is-hidden"))}function j(e){e.key==="Escape"&&L()}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".list-for-new-exercises").addEventListener("click",async t=>{const r=t.target.closest(".item-button");if(!r)return;let n=r.dataset.id;try{const s=await de(n);s&&(a=s,J(a),ce())}catch(s){console.log(s)}})});let z,a;function le(e){z=e}async function de(e){const t=`https://your-energy.b.goit.study/api/exercises/${e}`;try{return a=[(await T.get(t)).data],le(e),ue(a),ge(a),me(a),fe(a),pe(a),ye(a),a}catch(r){console.log(r)}}function ue(e){const t=document.querySelector(".modal-img");t.src=e[0].gifUrl}function ge(e){const t=document.querySelector(".ex-title");t.textContent=e[0].name}function me(e){const t=document.querySelector(".ex-description");t.textContent=e[0].description}function fe(e){const t=document.querySelector(".ratinng-value");t.textContent=Number.isInteger(e[0].rating)?`${e[0].rating}.0`:e[0].rating}function pe(e){const t=document.querySelector(".info-list");t.innerHTML=e.map(r=>{const{bodyPart:n,burnedCalories:s,target:u,equipment:b,popularity:w,time:k}=r;return`
      <li class="info-item_info"><span>Target</span> <span class="info-item">${u}</span></li>
      <li class="info-item_info"><span>Body Part</span> <span class="info-item">${n}</span></li>
      <li class="info-item_info"><span>Equipment</span> <span class="info-item">${b}</span></li>
      <li class="info-item_info"><span>Popular</span> <span class="info-item">${w}</span></li>
      <li class="info-item_info"><span>Burned Calories</span> <span class="info-item">${s}/${k} min</span></li>
  `}).join("")}function ye(e){const t=parseFloat(e[0].rating),r=document.querySelectorAll(".modal-rating-star-icon");for(let n=0;n<r.length;n++)n<t?r[n].classList.add("active"):r[n].classList.remove("active")}function B(){return JSON.parse(localStorage.getItem("favoriteExercises"))||[]}function U(e){localStorage.setItem(ae,JSON.stringify(e))}function G(e){return B().some(n=>n===e)}function he(e){const t=B();t.push(e),U(t)}function ve(e){const r=B().filter(n=>n!==e);U(r)}const x=document.querySelector(".btn-add-favorite");x.addEventListener("click",()=>{const e=a[0]._id;G(e)?(ve(e),x.textContent="Add to favorite ♡"):(he(e),x.textContent="Remove from favorite 🗑")});function J(e){const t=G(e);x.textContent=t?"Remove from favorite 🗑":"Add to favorite ♡"}const o={closeBtn:document.querySelector(".close-rating-btn"),ratingStars:document.querySelector(".rating-stars"),ratingForm:document.querySelector(".rating-feedback-form"),stars:document.querySelectorAll(".star"),openModalBtn:document.querySelector(".btn-give-rating"),exerciseModal:document.querySelector(".modal-ex"),ratingNumber:document.querySelector(".rating-number")};o.closeBtn.addEventListener("click",H);o.ratingStars.addEventListener("change",Ee);o.ratingForm.userEmail.addEventListener("input",X);o.ratingForm.userEmail.addEventListener("change",e=>{X(e)||K(e.currentTarget)});o.closeBtn.addEventListener("click",H);o.ratingForm.comment.addEventListener("change",be);o.ratingForm.addEventListener("submit",Te);function Ee(e){const t=e.currentTarget.firstElementChild;t.textContent=e.target.value+".0",e.target.labels[0].children[0].classList.add("animate"),W(o.stars),Le(e.target.value,o.stars);const r=setTimeout(()=>{e.target.labels[0].children[0].classList.remove("animate"),clearTimeout(r)},1700)}function _(e){e.style.borderColor="#f4f4f4"}function W(e){for(let t=0;t<5;t+=1)e[t].classList.remove("star-active")}function Le(e,t){for(let r=0;r<e;r+=1)t[r].classList.add("star-active")}function K(e){e.classList.add("error"),setTimeout(()=>{e.classList.remove("error")},600)}function X(e){return/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/iu.test(e.currentTarget.value)?(e.currentTarget.style.borderColor="#acdb9de5",!0):(e.currentTarget.style.borderColor="#bd7a7ae5",!1)}function be(e){e.currentTarget.value.length<5?(e.currentTarget.style.borderColor="#bd7a7ae5",K(e.currentTarget)):e.currentTarget.style.borderColor="#acdb9de5"}function xe(e,t,r){return{rate:e,email:t,review:r}}function Se(e,t){T.patch(`/exercises/${e}/rating`,t).then(r=>{S.Notify.success("Success")}).catch(r=>{S.Notify.failure(r.response.data.message)})}function Te(e){if(e.preventDefault(),!e.currentTarget.elements.userEmail.validity.valid){S.Notify.failure("Check email");return}let t=document.querySelector('input[name="star"]:checked');if(t===null){S.Notify.failure("Please select rating stars");return}const r=xe(Number(t.value),e.currentTarget.elements.userEmail.value,e.currentTarget.elements.comment.value);Se(z,r),_(e.currentTarget.elements.userEmail),_(e.currentTarget.elements.comment),W(o.stars),o.ratingNumber.textContent="0.0",e.currentTarget.reset(),H()}o.openModalBtn.addEventListener("click",we);function we(e){o.ratingForm.classList.remove("is-hidden"),o.exerciseModal.classList.add("is-hidden")}function H(){o.ratingForm.classList.add("is-hidden"),o.exerciseModal.classList.remove("is-hidden")}
