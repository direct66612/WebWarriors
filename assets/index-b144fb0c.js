import{a as S,s as m,r as y,b as v,c as P,n as $,N as x}from"./pagination-markup-86eb1ade.js";document.addEventListener("DOMContentLoaded",function(){document.getElementById("logo-link").addEventListener("click",function(){window.location.href="./index.html"}),document.getElementById("subscription-form").addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("email-input"),r=t.value;if(console.log(r),!t.checkValidity()){alert("https://your-energy.b.goit.study/api/subscription");return}fetch("https://your-energy.b.goit.study/api/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}).then(n=>n.json()).then(n=>{if(console.log(n.message),n.message==="Service not found")throw Error("Request error. Please try again later.");alert("You have successfully subscribed to receive new exercises!"),t.value=""}).catch(n=>{alert(n)})})});let q=document.querySelector(".top-button");window.onscroll=function(){X()};function X(){document.body.scrollTop>200||document.documentElement.scrollTop>200?q.style.display="block":q.style.display="none"}q.addEventListener("click",Y);function Y(){window.scrollTo({top:0,behavior:"smooth"})}async function C(e,t=1){let{filter:r="",category:n="",keyword:s=""}=e;switch(r){case"Body parts":r="bodypart";break;case"Muscles":r="muscles";break;case"Equipment":r="equipment";break}const u=new URLSearchParams({[r]:n,keyword:s,page:t,limit:window.innerWidth<768?8:10});return(await S.get("/exercises",{params:u})).data}function F(e){return e.map(t=>{const{rating:r,name:n,burnedCalories:s,time:u,bodyPart:L,target:w,_id:k}=t;return`
      <li class="item">
        <div class="item-header">
          <span class='item-workout'>Workout</span>
          <p class='item-rating js-rating'>${Number.isInteger(r)?`${r}.0`:r}</p>
          <svg class="rating-star" width="18" height="18">
            <use href="${m}#icon-exercises-content-gold-star"></use>
          </svg>
        </div>

        <div class="item-body">
          <svg class="" width="24" height="24">
            <use href="${m}#icon-running-man"></use>
          </svg>
          <h3 class="item-title js-item-title">${n}</h3>
        </div>

        <div class='item-footer'>
          <p>Burned calories: <span>${s} / ${u} min</span></p>
          <p>Body part: <span class="capitalize">${L}</span></p>
          <p>Target: <span class="capitalize">${w}</span></p>
        </div>

        <button class='item-button' data-id=${k} data-modal-open>Start
          <svg class="start-icon" width="16" height="16">
            <use href="${m}#icon-scroll-arrow"></use>
          </svg>
        </button>
      </li>
    `}).join("")}async function I(e,t){const n=new URLSearchParams({filter:e,page:t,limit:window.innerWidth<768?9:12});return await S.get("/filters",{params:n}).then(s=>s.data)}function Q(e){return e.map(({filter:t,name:r,imgURL:n})=>`
        <li class = "new-exercises-item">  
          <div class = "exercises-filter-IMG js-category-item js-item" style="
          background: linear-gradient(0deg, rgba(17, 17, 17, 0.50) 0%, rgba(17, 17, 17, 0.50) 100%), url('${n}'), lightgray -19.24px -11px / 112.354% 111.111% no-repeat; background-size: contain; background-size: cover;" data-category="${r}">
            <div class="container-for-h2-and-p-card">
              <h3 class="exercises-title-of-item js-item">${r}</h3>
              <p class="exercises-text-of-item js-item">${t}</p>
            </div>              
          </div>            
        </li>`).join("")}const D=`
  <div class="loader">
    <svg class="" width="24" height="24">
      <use href="${m}#icon-aside-barbell"></use>
    </svg>
  </div>
`,i={list:document.querySelector(".exercises-filter-list"),newList:document.querySelector(".list-for-new-exercises"),bodyPartsItem:document.querySelector(".filter-of-body-parts"),musclesItem:document.querySelector(".filter-of-muscles"),equipmentItem:document.querySelector(".filter-of-equipment"),pagination:document.querySelector(".pagination-nav"),title:document.querySelector(".exercises-main-title"),form:document.querySelector(".js-form")};let g=1;i.list.addEventListener("click",Z);i.newList.innerHTML=D;I(i.list.dataset.filter,g).then(e=>{e.totalPages===1&&(i.pagination.style.display="none"),i.newList.innerHTML="",H(e.results);let t=y(e.totalPages,g);i.pagination.innerHTML=v(g,t),i.pagination.addEventListener("click",N)}).catch(e=>{console.error("Error: ",e),P.Notify.failure("Oops. Something went wrong. Try reloading the page")});function Z(e){const t=e.target.dataset.category;e.target.classList.contains("exercises-filter-btn")&&([...e.currentTarget.children].forEach(r=>{r.children[0].classList.remove("active"),r.children[0].disabled=!1}),e.target.classList.add("active"),e.target.disabled=!0,i.title.textContent="Exercises",i.form.classList.add("is-hidden"),i.form.reset(),i.list.dataset.filter=t,I(t,g).then(r=>{r.totalPages<=1?i.pagination.style.display="none":i.pagination.style.display="block ",i.newList.innerHTML="",H(r.results);let n=y(r.totalPages,g);i.pagination.innerHTML=v(g,n),i.pagination.removeEventListener("click",V),i.pagination.addEventListener("click",N)}).catch(r=>{console.error("Error: ",r),P.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}function N(e){let t=e.target.dataset.page;t==="..."||!e.target.classList.contains("js-page-link")||t===""||e.target.classList.contains("active")||(window.scrollTo({top:i.title.offsetTop-60}),t=Number(t),I(i.list.dataset.filter,t).then(r=>{H(r.results);let n=y(r.totalPages,t);i.pagination.innerHTML=v(t,n)}).catch(r=>{console.error("Error: ",r),P.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}function H(e){Array.isArray(e)?(console.log(e),i.newList.innerHTML=Q(e)):console.error("Data is not an array:",e)}const T=document.querySelector(".js-form"),ee=document.querySelector(".exercises-main-title"),R=document.querySelector(".exercises-filter-list"),d=document.querySelector(".list-for-new-exercises");document.querySelector(".js-filter-nav");const c=document.querySelector(".pagination-nav"),l={filter:"",category:"",keyword:""};let f=1;d.addEventListener("click",te);function V(e){let t=e.target.dataset.page;t==="..."||!e.target.classList.contains("js-page-link")||e.target.classList.contains("active")||(window.scrollTo({top:d.offsetTop-210}),t=Number(t),C(l,t).then(r=>{d.innerHTML=F(r.results);let n=y(r.totalPages,t);c.innerHTML=v(t,n)}).catch(r=>{console.error(r),$.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}function te(e){e.target.classList.contains("js-item")&&(R.querySelector(".active").disabled=!1,d.innerHTML=D,M(),c.removeEventListener("click",N),c.addEventListener("click",V),l.filter=R.dataset.filter,l.category=e.target.closest(".js-category-item").dataset.category,T.classList.remove("is-hidden"),T.addEventListener("input",ie),C(l,f).then(t=>{t.totalPages<=1?c.style.display="none":c.style.display="block";const r=l.category[0].toUpperCase()+l.category.slice(1);d.innerHTML="",ee.innerHTML=`Exercises / <span>${r}</span>`,d.innerHTML=F(t.results);let n=y(t.totalPages,f);c.innerHTML=v(f,n)}).catch(t=>{console.error(t),$.Notify.failure("Oops. Something went wrong. Try reloading the page")}))}const re=`
  <svg class="search-icon" width="26" height="26">
    <use href="${m}#icon-search"></use>
  </svg>
`,ne=`
  <svg class="clear-icon" width="18" height="18">
    <use href="${m}#icon-remove"></use>
  </svg>
`;function ie(e){const{input:t,button:r}=e.currentTarget.elements;t.value.length>0?(r.innerHTML=ne,r.addEventListener("click",M)):(r.removeEventListener("click",M),r.innerHTML=re);const n=t.value.replace(/\s{2,}/g," ");t.value=n,l.keyword=n,C(l,f).then(s=>{if(s.results.length===0){d.innerHTML='<p><b style="font-size: 28px">No matches found</b> <br>Please try another search</p>',c.innerHTML="";return}s.totalPages<=1?c.style.display="none":c.style.display="block",d.innerHTML=F(s.results);let u=y(s.totalPages,f);c.innerHTML=v(f,u)}).catch(s=>{console.error(s),$.Notify.failure("Oops. Something went wrong. Try reloading the page")}).finally(()=>{l.keyword=""})}function M(){T.reset();const e=new Event("input",{bubbles:!0,cancelable:!0});T.dispatchEvent(e)}const p=document.querySelector(".backdrop-ex"),se=document.querySelector(".modal-close-btn"),h=document.querySelector(".modal-ex"),oe="favoriteExercises";se.addEventListener("click",E);document.addEventListener("keydown",j);const _=document.querySelector(".rating-feedback-form");p.addEventListener("click",e=>{e.target===p&&E()});function ae(){h&&(document.querySelector("body").style.overflow="hidden",h.classList.remove("is-hidden"),p.classList.remove("is-hidden"),document.addEventListener("keydown",j),h.addEventListener("click",e=>{e.stopPropagation()}),p.removeEventListener("click",E),J(a[0]._id))}function E(){h&&(document.querySelector("body").style.overflow="visible",h.classList.add("is-hidden"),document.removeEventListener("keydown",j),p.removeEventListener("click",E),p.classList.add("is-hidden"),_.classList.add("visually-hidden"),_.classList.remove("rating-form-active"))}function j(e){e.key==="Escape"&&E()}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".list-for-new-exercises").addEventListener("click",async t=>{const r=t.target.closest(".item-button");if(!r)return;let n=r.dataset.id;try{const s=await le(n);s&&(a=s,J(a),ae())}catch(s){console.log(s)}})});let z,a;function ce(e){z=e}async function le(e){const t=`https://your-energy.b.goit.study/api/exercises/${e}`;try{return a=[(await S.get(t)).data],ce(e),de(a),ue(a),me(a),ge(a),fe(a),pe(a),a}catch(r){console.log(r)}}function de(e){const t=document.querySelector(".modal-img");t.src=e[0].gifUrl}function ue(e){const t=document.querySelector(".ex-title");t.textContent=e[0].name}function me(e){const t=document.querySelector(".ex-description");t.textContent=e[0].description}function ge(e){const t=document.querySelector(".ratinng-value");t.textContent=Number.isInteger(e[0].rating)?`${e[0].rating}.0`:e[0].rating}function fe(e){const t=document.querySelector(".info-list");t.innerHTML=e.map(r=>{const{bodyPart:n,burnedCalories:s,target:u,equipment:L,popularity:w,time:k}=r;return`
      <li class="info-item_info"><span>Target</span> <span class="info-item">${u}</span></li>
      <li class="info-item_info"><span>Body Part</span> <span class="info-item">${n}</span></li>
      <li class="info-item_info"><span>Equipment</span> <span class="info-item">${L}</span></li>
      <li class="info-item_info"><span>Popular</span> <span class="info-item">${w}</span></li>
      <li class="info-item_info"><span>Burned Calories</span> <span class="info-item">${s}/${k} min</span></li>
  `}).join("")}function pe(e){const t=parseFloat(e[0].rating),r=document.querySelectorAll(".modal-rating-star-icon");for(let n=0;n<r.length;n++)n<t?r[n].classList.add("active"):r[n].classList.remove("active")}function B(){return JSON.parse(localStorage.getItem("favoriteExercises"))||[]}function U(e){localStorage.setItem(oe,JSON.stringify(e))}function G(e){return B().some(n=>n===e)}function ye(e){const t=B();t.push(e),U(t)}function ve(e){const r=B().filter(n=>n!==e);U(r)}const b=document.querySelector(".btn-add-favorite");b.addEventListener("click",()=>{const e=a[0]._id;G(e)?(ve(e),b.textContent="Add to favorite ♡"):(ye(e),b.textContent="Remove from favorite 🗑")});function J(e){const t=G(e);b.textContent=t?"Remove from favorite 🗑":"Add to favorite ♡"}const o={closeBtn:document.querySelector(".close-rating-btn"),ratingStars:document.querySelector(".rating-stars"),ratingForm:document.querySelector(".rating-feedback-form"),stars:document.querySelectorAll(".star"),openModalBtn:document.querySelector(".btn-give-rating"),exerciseModal:document.querySelector(".modal-ex"),ratingNumber:document.querySelector(".rating-number")};o.closeBtn.addEventListener("click",O);o.ratingStars.addEventListener("change",he);o.ratingForm.userEmail.addEventListener("input",K);o.ratingForm.userEmail.addEventListener("change",e=>{K(e)||W(e.currentTarget)});o.closeBtn.addEventListener("click",O);o.ratingForm.comment.addEventListener("change",Le);o.ratingForm.addEventListener("submit",Te);function he(e){const t=e.currentTarget.firstElementChild;o.ratingNumber.textContent=e.target.value+".0",console.log(t),e.target.labels[0].children[0].classList.add("animate");const r=setTimeout(()=>{e.target.labels[0].children[0].classList.remove("animate"),clearTimeout(r)},1700)}function A(e){e.style.borderColor="#f4f4f4"}function W(e){e.classList.add("error"),setTimeout(()=>{e.classList.remove("error")},600)}function Ee(e){e.classList.add("form-error"),setTimeout(()=>{e.classList.remove("form-error")},800)}function K(e){return/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/iu.test(e.currentTarget.value)?(e.currentTarget.style.borderColor="#acdb9de5",!0):(e.currentTarget.style.borderColor="#bd7a7ae5",!1)}function Le(e){e.currentTarget.value.length<5?(e.currentTarget.style.borderColor="#bd7a7ae5",W(e.currentTarget)):e.currentTarget.style.borderColor="#acdb9de5"}function be(e,t,r){return{rate:e,email:t,review:r}}function xe(e,t){S.patch(`/exercises/${e}/rating`,t).then(r=>{x.Notify.success("Success"),O()}).catch(r=>{x.Notify.failure(r.response.data.message),Ee(o.ratingForm)})}function Te(e){if(e.preventDefault(),!e.currentTarget.elements.userEmail.validity.valid){x.Notify.failure("Check email");return}let t=document.querySelector('input[name="star"]:checked');if(t===null){x.Notify.failure("Please select rating stars");return}const r=be(Number(t.value),e.currentTarget.elements.userEmail.value,e.currentTarget.elements.comment.value);xe(z,r),A(e.currentTarget.elements.userEmail),A(e.currentTarget.elements.comment),o.ratingNumber.textContent="0.0",e.currentTarget.reset()}o.openModalBtn.addEventListener("click",Se);function Se(e){o.ratingForm.classList.remove("visually-hidden"),o.ratingForm.classList.add("rating-form-active"),o.exerciseModal.classList.add("is-hidden")}function O(){o.ratingForm.classList.add("visually-hidden"),o.ratingForm.classList.remove("rating-form-active"),o.exerciseModal.classList.remove("is-hidden")}
